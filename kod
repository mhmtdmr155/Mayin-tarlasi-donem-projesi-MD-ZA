#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define N 10
#define MAYIN_ORANI 0.05
#define G 'G'
#define C 'Ç'
#define MAYIN 'X'
#define BOS_ALAN 'O'

char tahta[N][N];
int oyuncuX, oyuncuY;

// Fonksiyonları tanımlama kısmı
void tahtaSifirla();

void mayinlariYerlestir();

void oyunTahtasiniYazdir();

void oyuncuHamlesiAl();

int oyunDurumuKontrol();





int main() {
    srand(time(NULL));

    while (1) {
    tahtaSifirla();
    mayinlariYerlestir();
    oyuncuX = 0;
    oyuncuY = 0;

        while (1) {
        oyunTahtasiniYazdir();
        oyuncuHamlesiAl();

         int durum = oyunDurumuKontrol();
         if (durum == 1) {
                printf("Tebrikler oyunu kazandınız\n");
                break;
            } else if (durum == -1) {
                printf("Oyunu kaybettiniz. Yeniden denemek ister misiniz? (E): \n");
                printf("Oyunu kaybettiniz.oyunu bitirmek isterseniz (H): \n");
				char cevap;
                scanf(" %c", &cevap);
                if (cevap != 'E' && cevap != 'e') {
                    printf("Oyun sona erdi. iyi gunler\n");
                    return 0;
                } else {
                    break;
                }
            }
        }
    }

    return 0;
}







void tahtaSifirla() 
{
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            tahta[i][j] = BOS_ALAN;
        }
    }
    tahta[oyuncuX][oyuncuY] = G;
    tahta[N - 1][N - 1] = C;
}





void mayinlariYerlestir() 
{
    int toplamMayin = N * N * MAYIN_ORANI;

    while (toplamMayin > 0) {
        int x = rand() % N;
        int y = rand() % N;

        if (tahta[x][y] != MAYIN && tahta[x][y] != G && tahta[x][y] != C) {
            tahta[x][y] = MAYIN;
            toplamMayin--;
        }
    }
}


void oyunTahtasiniGizliYazdir() 
{
    system("cls");  // Windows için "cls", Linux için "clear"
    for (int i = 0; i < N; i++) {
        for (int j = 0; j < N; j++) {
            if (i == oyuncuX && j == oyuncuY) {
                printf("%c ", G);  // Oyuncunun mevcut konumu
            } else if (tahta[i][j] == C) {
                printf("%c ", BOS_ALAN);  // Çıkış noktasını göster
            } else {
                printf("%c ", BOS_ALAN);  // Mayınları gösterme
            }
        }
        printf("\n");
    }
    printf("\n");
}




void oyunTahtasiniYazdir() 
{
    if (tahta[oyuncuX][oyuncuY] == MAYIN) {
        oyunTahtasiniGizliYazdir();
        printf("Mayına çarptınız! Oyunu kaybettiniz.\n");
        exit(0);  // Oyuncu kaybetti, programı sonlandır
    } else if (tahta[oyuncuX][oyuncuY] == C) {
        oyunTahtasiniGizliYazdir();
        printf("Tebrikler! Oyunu kazandınız!\n");
        exit(0);  // Oyuncu kazandı, programı sonlandır
    } else {
        oyunTahtasiniGizliYazdir();
    }
}



void oyuncuHamlesiAl() 
{
    printf("Yon tuslariyla hareket edin (w,a,s,d): ");
    char hareket;
    scanf(" %c", &hareket);
    
       int yeniX = oyuncuX;
    int yeniY = oyuncuY;

    switch (hareket) {
        case 'w':
            if (oyuncuX > 0)
                oyuncuX--;
            break;
        case 'a':
            if (oyuncuY > 0)
                oyuncuY--;
            break;
        case 's':
            if (oyuncuX < N - 1)
                oyuncuX++;
            break;
        case 'd':
            if (oyuncuY < N - 1)
                oyuncuY++;
            break;
        default:
            printf("Gecersiz hamle Lutfen yon tuslarını kullanın.(w,a,s,d)\n");
    }
}

int oyunDurumuKontrol() 
{
    if (tahta[oyuncuX][oyuncuY] == MAYIN) {
        return -1;  // Oyunu kaybetmek
    } else if (tahta[oyuncuX][oyuncuY] == C) {
        return 1;   // Oyunu kazanmak
    }

    return 0;
}
